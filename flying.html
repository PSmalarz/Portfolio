<!doctype html>
<html lang="pl">
	<head>
		<meta charset="UTF-8" />
		<meta name="viewport" content="width=device-width, initial-scale=1.0" />
		<title>Flappy Cat üê±</title>

		<style>
			* {
				margin: 0;
				padding: 0;
				box-sizing: border-box;
				user-select: none;
				touch-action: manipulation;
			}

			body {
				height: 100vh;
				background: radial-gradient(circle at top, #1a0f2e, #05010a);
				display: flex;
				justify-content: center;
				align-items: center;
				font-family: Arial, sans-serif;
			}

			canvas {
				background: linear-gradient(#0c0718, #14082b);
				border-radius: 20px;
				box-shadow: 0 0 35px rgba(180, 120, 255, 0.35);
			}
		</style>
	</head>

	<body>
		<canvas id="game"></canvas>

		<script>
			const canvas = document.getElementById("game");
			const ctx = canvas.getContext("2d");

			function resize() {
				canvas.width = Math.min(window.innerWidth - 20, 420);
				canvas.height = Math.min(window.innerHeight - 40, 640);
			}
			resize();
			window.addEventListener("resize", resize);

			// ===== AUDIO Z PLIK√ìW =====
			// Wstaw ≈õcie≈ºki do swoich plik√≥w mp3
			const sndJump = new Audio("jump.mp3"); // d≈∫wiƒôk skoku
			const sndFish = new Audio("fish.mp3"); // zebranie rybki
			const sndHit = new Audio("hit.mp3"); // uderzenie w p≈Çot
			const sndBg = new Audio("bg.mp3"); // muzyka w tle
			sndBg.loop = true;
			sndBg.volume = 0.3;

			// ===== STAN =====
			let started = false;
			let gameOver = false;
			let frame = 0;
			let score = 0;

			// ===== KOTEK (EMOJI) =====
			const cat = {
				x: 90,
				y: canvas.height / 2,
				size: 30,
				velocity: 0,
				gravity: 0.14,
				jump: -4.2,
			};

			// ===== PRZESZKODY =====
			let fences = [];
			const gap = 200;
			const fenceWidth = 54;
			const speed = 1.3;

			// ===== RYBKI (EMOJI) =====
			let fishes = [];

			// ===== GWIAZDKI T≈ÅA =====
			const stars = Array.from({ length: 45 }, () => ({
				x: Math.random() * canvas.width,
				y: Math.random() * canvas.height,
				r: Math.random() * 1.5 + 0.5,
				s: Math.random() * 0.25 + 0.1,
			}));

			// ===== INPUT =====
			function input() {
				if (!started) {
					started = true;
					sndBg.play();
					return;
				}
				if (gameOver) {
					reset();
					return;
				}
				cat.velocity = cat.jump;
				sndJump.currentTime = 0;
				sndJump.play();
			}
			window.addEventListener("click", input);
			window.addEventListener("touchstart", input);

			// ===== RESET =====
			function reset() {
				started = false;
				gameOver = false;
				frame = 0;
				score = 0;
				fences = [];
				fishes = [];
				cat.y = canvas.height / 2;
				cat.velocity = 0;
			}

			// ===== RYSOWANIE =====
			function drawCat() {
				ctx.font = "30px serif";
				ctx.fillText("üê±", cat.x - 15, cat.y + 15);
			}

			function drawFence(f) {
				const grad = ctx.createLinearGradient(f.x, 0, f.x + fenceWidth, 0);
				grad.addColorStop(0, "#3a0ca3");
				grad.addColorStop(1, "#7209b7");

				ctx.fillStyle = grad;
				ctx.shadowColor = "#b983ff";
				ctx.shadowBlur = 12;

				ctx.fillRect(f.x, 0, fenceWidth, f.top);
				ctx.fillRect(f.x, f.top + gap, fenceWidth, canvas.height);

				ctx.shadowBlur = 0;
			}

			function drawFish(f) {
				ctx.font = "22px serif";
				ctx.fillText("üêü", f.x - 11, f.y + 11);
			}

			// ===== UPDATE =====
			function update() {
				if (!started || gameOver) return;

				cat.velocity += cat.gravity;
				cat.velocity = Math.min(cat.velocity, 3.5);
				cat.y += cat.velocity;

				if (cat.y < 0 || cat.y > canvas.height) {
					gameOver = true;
					sndHit.play();
					sndBg.pause();
				}

				if (frame % 240 === 0) {
					const top = Math.random() * (canvas.height - gap - 160) + 80;
					fences.push({ x: canvas.width + 20, top, passed: false });
					fishes.push({ x: canvas.width + 20, y: top + gap / 2 });
				}

				fences.forEach((f) => {
					f.x -= speed;

					if (
						cat.x + cat.size / 2 > f.x &&
						cat.x - cat.size / 2 < f.x + fenceWidth &&
						(cat.y < f.top || cat.y > f.top + gap)
					) {
						gameOver = true;
						sndHit.play();
						sndBg.pause();
					}

					if (!f.passed && f.x + fenceWidth < cat.x) {
						f.passed = true;
						score++;
					}
				});

				fishes.forEach((f, i) => {
					f.x -= speed;
					if (Math.hypot(cat.x - f.x, cat.y - f.y) < 20) {
						score += 2;
						sndFish.currentTime = 0;
						sndFish.play();
						fishes.splice(i, 1);
					}
				});

				fences = fences.filter((f) => f.x + fenceWidth > 0);
				fishes = fishes.filter((f) => f.x > -20);
			}

			// ===== T≈ÅO =====
			function drawBackground() {
				ctx.fillStyle = "#0c0718";
				ctx.fillRect(0, 0, canvas.width, canvas.height);

				ctx.fillStyle = "#b983ff";
				stars.forEach((s) => {
					s.y += s.s;
					if (s.y > canvas.height) s.y = 0;
					ctx.beginPath();
					ctx.arc(s.x, s.y, s.r, 0, Math.PI * 2);
					ctx.fill();
				});
			}

			// ===== DRAW =====
			function draw() {
				drawBackground();
				fences.forEach(drawFence);
				fishes.forEach(drawFish);
				drawCat();

				ctx.fillStyle = "#e6ccff";
				ctx.font = "18px Arial";
				ctx.fillText("Wynik: " + score, 14, 26);

				if (!started) {
					ctx.fillStyle = "rgba(0,0,0,0.6)";
					ctx.fillRect(0, 0, canvas.width, canvas.height);
					ctx.fillStyle = "#e6ccff";
					ctx.font = "24px Arial";
					ctx.fillText(
						"Flappy Cat üê±",
						canvas.width / 2 - 70,
						canvas.height / 2,
					);
					ctx.font = "14px Arial";
					ctx.fillText(
						"Kliknij, aby zaczƒÖƒá (chill)",
						canvas.width / 2 - 90,
						canvas.height / 2 + 22,
					);
				}

				if (gameOver) {
					ctx.fillStyle = "rgba(0,0,0,0.7)";
					ctx.fillRect(0, 0, canvas.width, canvas.height);
					ctx.fillStyle = "#ffccff";
					ctx.font = "22px Arial";
					ctx.fillText(
						"Spokojnie üòº",
						canvas.width / 2 - 60,
						canvas.height / 2,
					);
					ctx.font = "14px Arial";
					ctx.fillText(
						"Kliknij, ≈ºeby spr√≥bowaƒá jeszcze raz",
						canvas.width / 2 - 115,
						canvas.height / 2 + 24,
					);
				}
			}

			// ===== LOOP =====
			function loop() {
				frame++;
				update();
				draw();
				requestAnimationFrame(loop);
			}
			loop();
		</script>
	</body>
</html>
